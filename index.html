<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ§° Jarvis Toolkit</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #05050b;
            --bg-secondary: #101019;
            --bg-card: #161625;
            --bg-elevated: #1d1d2f;
            --accent-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --accent-cyan: #48dbfb;
            --accent-purple: #a855f7;
            --accent-pink: #f472b6;
            --accent-green: #34d399;
            --text-primary: #f9fafb;
            --text-secondary: #9ca3af;
            --border-color: rgba(255,255,255,0.08);
            --border-strong: rgba(255,255,255,0.18);
            --shadow-soft: 0 10px 40px rgba(15, 23, 42, 0.35);
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        a { color: inherit; }

        /* Animated background */
        .bg-animation {
            position: fixed;
            inset: 0;
            z-index: -1;
            overflow: hidden;
        }

        .bg-animation::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(102, 126, 234, 0.25) 0%, transparent 55%),
                radial-gradient(ellipse at 80% 80%, rgba(168, 85, 247, 0.18) 0%, transparent 55%),
                radial-gradient(ellipse at 50% 50%, rgba(72, 219, 251, 0.12) 0%, transparent 50%);
            animation: bgPulse 18s ease-in-out infinite;
        }

        @keyframes bgPulse {
            0%, 100% { transform: translate(0, 0) scale(1); }
            33% { transform: translate(2%, 1%) scale(1.02); }
            66% { transform: translate(-1%, -2%) scale(1.03); }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 24px 20px 80px;
        }

        header {
            text-align: center;
            padding: 60px 0 30px;
        }

        header h1 {
            font-size: clamp(2.4rem, 4vw, 3.1rem);
            font-weight: 700;
            letter-spacing: 0.02em;
            background: var(--accent-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 15px;
        }

        header p {
            color: var(--text-secondary);
            font-size: 1.05rem;
        }

        .tabs {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 12px;
            margin: 40px 0;
        }

        .tab-btn {
            padding: 12px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 14px;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 500;
            letter-spacing: 0.01em;
            transition: all 0.25s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: inset 0 0 0 rgba(102, 126, 234, 0);
        }

        .tab-btn:hover {
            border-color: rgba(102, 126, 234, 0.4);
            color: #e5e7eb;
            transform: translateY(-2px);
        }

        .tab-btn.active {
            background: var(--accent-gradient);
            color: #ffffff;
            border-color: transparent;
            box-shadow: var(--shadow-soft);
        }

        .tool-content {
            display: none;
            animation: fadeIn 0.45s ease;
        }

        .tool-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(12px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 26px;
            padding: 32px;
            box-shadow: var(--shadow-soft);
        }

        .card h2 {
            font-size: 1.45rem;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .card h2 span {
            font-size: 1.25em;
        }

        .card-subtitle {
            color: var(--text-secondary);
            margin-bottom: 20px;
            font-size: 0.95rem;
        }

        .grid {
            display: grid;
            gap: 20px;
        }

        .grid.two {
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
        }

        .grid.three {
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        }

        .chip {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            border-radius: 999px;
            background: rgba(102, 126, 234, 0.12);
            border: 1px solid rgba(102, 126, 234, 0.35);
            font-size: 0.8rem;
            color: var(--accent-cyan);
        }

        .field-label {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 8px;
            display: block;
        }

        .input, select, textarea {
            width: 100%;
            padding: 14px 16px;
            border-radius: 14px;
            border: 1px solid var(--border-color);
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 1rem;
            transition: border 0.2s ease, box-shadow 0.2s ease;
        }

        .input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: rgba(102, 126, 234, 0.6);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.25);
        }

        textarea {
            min-height: 160px;
            font-family: 'JetBrains Mono', monospace;
            resize: vertical;
        }

        .inline-group {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .btn {
            padding: 12px 20px;
            border-radius: 12px;
            border: 1px solid transparent;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 0.95rem;
        }

        .btn-primary {
            background: var(--accent-gradient);
            color: #ffffff;
            box-shadow: 0 12px 30px rgba(102, 126, 234, 0.28);
        }

        .btn-secondary {
            background: rgba(102, 126, 234, 0.12);
            color: var(--accent-cyan);
            border: 1px solid rgba(102, 126, 234, 0.35);
        }

        .btn-ghost {
            background: transparent;
            color: var(--text-secondary);
            border: 1px solid var(--border-color);
        }

        .btn:hover {
            transform: translateY(-1px);
        }

        .btn:active {
            transform: translateY(0);
        }

        .status-text {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-top: 12px;
        }

        /* Weather */
        .weather-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 18px;
        }

        .weather-card {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.22), rgba(168, 85, 247, 0.22));
            border-radius: 18px;
            padding: 22px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.25s ease, border 0.25s ease, box-shadow 0.25s ease;
            border: 1px solid transparent;
        }

        .weather-card.active {
            border-color: var(--accent-cyan);
            box-shadow: 0 0 28px rgba(72, 219, 251, 0.28);
        }

        .weather-city {
            font-size: 1.05rem;
            font-weight: 600;
            margin-bottom: 6px;
        }

        .weather-temp {
            font-size: 2.2rem;
            font-weight: 700;
            background: var(--accent-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .weather-condition {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-top: 6px;
        }

        .weather-detail {
            margin-top: 24px;
            padding: 22px;
            border-radius: 18px;
            background: var(--bg-elevated);
            border: 1px solid rgba(72, 219, 251, 0.3);
        }

        /* Calculator */
        .calculator {
            max-width: 420px;
            margin: 0 auto;
        }

        .calc-display {
            background: var(--bg-secondary);
            border-radius: 18px;
            padding: 22px;
            margin-bottom: 18px;
            text-align: right;
            border: 1px solid var(--border-color);
        }

        .calc-expression {
            color: var(--text-secondary);
            font-size: 0.95rem;
            min-height: 24px;
            font-family: 'JetBrains Mono', monospace;
            word-break: break-all;
        }

        .calc-result {
            font-size: 2.6rem;
            font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
        }

        .calc-grid {
            display: grid;
            grid-template-columns: repeat(4, minmax(0, 1fr));
            gap: 12px;
        }

        .calc-btn {
            padding: 18px;
            border-radius: 14px;
            border: 1px solid rgba(255,255,255,0.05);
            background: var(--bg-secondary);
            color: #e5e7eb;
            font-size: 1.15rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.15s ease, background 0.15s ease;
        }

        .calc-btn.operator {
            color: var(--accent-cyan);
            background: rgba(102, 126, 234, 0.2);
        }

        .calc-btn.equals {
            background: var(--accent-gradient);
            color: #fff;
            grid-column: span 2;
            box-shadow: 0 12px 28px rgba(102, 126, 234, 0.28);
        }

        .calc-btn.clear {
            color: var(--accent-pink);
        }

        .calc-btn:hover {
            transform: translateY(-1px);
        }

        .calc-btn:active {
            transform: translateY(0);
        }

        /* Unit converter */
        .converter-block + .converter-block {
            margin-top: 32px;
            padding-top: 28px;
            border-top: 1px solid var(--border-color);
        }

        .converter-inputs {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 18px;
            align-items: center;
        }

        .converter-arrow {
            font-size: 1.6rem;
            color: var(--accent-cyan);
        }

        .converter-result {
            margin-top: 14px;
            font-size: 1.4rem;
            font-weight: 600;
            text-align: center;
        }

        @media (max-width: 720px) {
            .converter-inputs {
                grid-template-columns: 1fr;
            }
            .converter-arrow { display: none; }
        }

        /* BMI */
        .bmi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .bmi-result {
            margin-top: 26px;
            padding: 26px;
            border-radius: 18px;
            border: 1px solid transparent;
            background: var(--bg-elevated);
            text-align: center;
            display: none;
        }

        .bmi-result.show {
            display: block;
        }

        .bmi-value {
            font-size: 3.1rem;
            font-weight: 700;
        }

        .bmi-category {
            font-size: 1.1rem;
            margin-top: 8px;
        }

        .bmi-scale {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            height: 12px;
            border-radius: 6px;
            overflow: hidden;
            margin-top: 20px;
        }

        .bmi-scale div:nth-child(1) { background: #60a5fa; }
        .bmi-scale div:nth-child(2) { background: #34d399; }
        .bmi-scale div:nth-child(3) { background: #fbbf24; }
        .bmi-scale div:nth-child(4) { background: #f87171; }

        /* Timer */
        .timer-display {
            font-size: clamp(3rem, 8vw, 4.4rem);
            font-weight: 700;
            text-align: center;
            font-family: 'JetBrains Mono', monospace;
            background: var(--accent-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 26px 0;
        }

        .timer-inputs {
            display: flex;
            justify-content: center;
            gap: 16px;
            flex-wrap: wrap;
        }

        .timer-inputs input {
            width: 90px;
            padding: 16px;
            text-align: center;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 14px;
            color: var(--text-primary);
            font-size: 1.3rem;
        }

        .timer-controls {
            display: flex;
            justify-content: center;
            gap: 16px;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        /* Currency converter */
        .rates-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 18px;
        }

        .rate-badge {
            background: rgba(56, 189, 248, 0.12);
            border: 1px solid rgba(56, 189, 248, 0.35);
            padding: 14px 18px;
            border-radius: 16px;
            font-size: 0.9rem;
            color: rgba(224, 242, 254, 0.92);
        }

        .currency-result {
            font-size: clamp(1.6rem, 4vw, 2.2rem);
            font-weight: 700;
            margin-top: 22px;
        }

        /* Password generator */
        .switch {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 10px 14px;
            border-radius: 12px;
            background: rgba(148, 163, 184, 0.08);
            border: 1px solid rgba(148, 163, 184, 0.15);
        }

        .switch input {
            accent-color: #6366f1;
            width: 18px;
            height: 18px;
        }

        .range-wrapper {
            display: flex;
            align-items: center;
            gap: 14px;
        }

        .range-wrapper span {
            font-variant-numeric: tabular-nums;
            font-weight: 600;
        }

        input[type="range"] {
            flex: 1;
        }

        .password-output {
            margin-top: 18px;
            padding: 18px 20px;
            border-radius: 16px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            font-family: 'JetBrains Mono', monospace;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 16px;
        }

        .password-output span {
            font-size: 1.1rem;
            word-break: break-word;
        }

        /* Color picker */
        .color-preview {
            width: 120px;
            height: 120px;
            border-radius: 22px;
            border: 1px solid var(--border-color);
            box-shadow: inset 0 0 20px rgba(15, 23, 42, 0.35);
        }

        .color-values {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .color-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid rgba(148, 163, 184, 0.15);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.95rem;
        }

        /* JSON tool */
        .json-actions {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            margin-top: 16px;
        }

        .json-output {
            margin-top: 20px;
            padding: 20px;
            border-radius: 18px;
            background: var(--bg-elevated);
            border: 1px solid var(--border-color);
            font-family: 'JetBrains Mono', monospace;
            white-space: pre-wrap;
            word-break: break-word;
            max-height: 320px;
            overflow: auto;
        }

        .error-text {
            color: #f87171;
            font-size: 0.9rem;
            margin-top: 10px;
        }

        footer {
            text-align: center;
            padding: 50px 0 20px;
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        footer a {
            color: var(--accent-cyan);
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="bg-animation"></div>

    <div class="container">
        <header>
            <h1>ğŸ§° Jarvis Toolkit</h1>
            <p>è½»ç›ˆ Â· é«˜æ•ˆ Â· æš—è‰²ä¸»é¢˜å®ç”¨å·¥å…·åˆé›†</p>
        </header>

        <nav class="tabs" aria-label="Toolkit navigation">
            <button class="tab-btn active" data-tab="weather">ğŸŒ¤ï¸ å¤©æ°”</button>
            <button class="tab-btn" data-tab="calculator">ğŸ§® è®¡ç®—å™¨</button>
            <button class="tab-btn" data-tab="converter">ğŸ“ å•ä½è½¬æ¢</button>
            <button class="tab-btn" data-tab="bmi">âš–ï¸ BMI</button>
            <button class="tab-btn" data-tab="timer">â±ï¸ è®¡æ—¶å™¨</button>
            <button class="tab-btn" data-tab="currency">ğŸ’± æ±‡ç‡è½¬æ¢</button>
            <button class="tab-btn" data-tab="password">ğŸ” å¯†ç ç”Ÿæˆå™¨</button>
            <button class="tab-btn" data-tab="color">ğŸ¨ é¢œè‰²é€‰æ‹©å™¨</button>
            <button class="tab-btn" data-tab="json">ğŸ§¾ JSON æ ¼å¼åŒ–</button>
        </nav>

        <!-- Weather -->
        <section id="weather" class="tool-content active" aria-labelledby="weather">
            <div class="card">
                <h2><span>ğŸŒ¤ï¸</span>å…¨çƒåŸå¸‚å¤©æ°”</h2>
                <p class="card-subtitle">ç‚¹å‡»åˆ‡æ¢åŸå¸‚ï¼Œä¸‹æ–¹æ˜¾ç¤ºå½“å‰é€‰ä¸­åŸå¸‚çš„å¤©æ°”çŠ¶å†µ</p>

                <div class="weather-grid" id="weather-grid">
                    <article class="weather-card active" data-city="é©¬å¾·é‡Œ" data-temp="12" data-condition="æ™´æœ—" data-emoji="â˜€ï¸">
                        <div class="weather-city">ğŸ‡ªğŸ‡¸ é©¬å¾·é‡Œ</div>
                        <div class="weather-temp">12Â°C</div>
                        <div class="weather-condition">æ™´æœ—</div>
                    </article>
                    <article class="weather-card" data-city="åŒ—äº¬" data-temp="3" data-condition="å¤šäº‘" data-emoji="â„ï¸">
                        <div class="weather-city">ğŸ‡¨ğŸ‡³ åŒ—äº¬</div>
                        <div class="weather-temp">3Â°C</div>
                        <div class="weather-condition">å¤šäº‘</div>
                    </article>
                    <article class="weather-card" data-city="çº½çº¦" data-temp="8" data-condition="å°é›¨" data-emoji="ğŸŒ§ï¸">
                        <div class="weather-city">ğŸ‡ºğŸ‡¸ çº½çº¦</div>
                        <div class="weather-temp">8Â°C</div>
                        <div class="weather-condition">å°é›¨</div>
                    </article>
                    <article class="weather-card" data-city="ä¸œäº¬" data-temp="15" data-condition="æ™´æœ—" data-emoji="ğŸŒ¤ï¸">
                        <div class="weather-city">ğŸ‡¯ğŸ‡µ ä¸œäº¬</div>
                        <div class="weather-temp">15Â°C</div>
                        <div class="weather-condition">æ™´æœ—</div>
                    </article>
                    <article class="weather-card" data-city="ä¼¦æ•¦" data-temp="9" data-condition="å°é›¨" data-emoji="ğŸŒ§ï¸">
                        <div class="weather-city">ğŸ‡¬ğŸ‡§ ä¼¦æ•¦</div>
                        <div class="weather-temp">9Â°C</div>
                        <div class="weather-condition">å°é›¨</div>
                    </article>
                    <article class="weather-card" data-city="å·´é»" data-temp="11" data-condition="å¤šäº‘" data-emoji="â›…">
                        <div class="weather-city">ğŸ‡«ğŸ‡· å·´é»</div>
                        <div class="weather-temp">11Â°C</div>
                        <div class="weather-condition">å¤šäº‘</div>
                    </article>
                </div>

                <div class="weather-detail" id="weather-detail" aria-live="polite"></div>
            </div>
        </section>

        <!-- Calculator -->
        <section id="calculator" class="tool-content" aria-labelledby="calculator">
            <div class="card">
                <h2><span>ğŸ§®</span>ç§‘å­¦è¿ç®—è®¡ç®—å™¨</h2>
                <p class="card-subtitle">æ”¯æŒåŠ å‡ä¹˜é™¤ã€ç™¾åˆ†å·ä¸å°æ•°ï¼Œé”®ç›˜è¾“å…¥åŒæ ·é€‚ç”¨</p>

                <div class="calculator">
                    <div class="calc-display">
                        <div class="calc-expression" id="calc-expression"></div>
                        <div class="calc-result" id="calc-result">0</div>
                    </div>
                    <div class="calc-grid" id="calc-grid"></div>
                </div>
            </div>
        </section>

        <!-- Unit Converter -->
        <section id="converter" class="tool-content" aria-labelledby="converter">
            <div class="card">
                <h2><span>ğŸ“</span>å¤šå•ä½è½¬æ¢</h2>
                <p class="card-subtitle">é•¿åº¦ã€é‡é‡ã€æ¸©åº¦ä¸€é”®è½¬æ¢ï¼Œæ”¯æŒå¸¸è§å›½é™…å•ä½</p>

                <div class="converter-block" data-type="length">
                    <div class="inline-group" style="justify-content: space-between;">
                        <h3 style="font-size: 1.05rem;">é•¿åº¦è½¬æ¢</h3>
                        <span class="chip">m Â· km Â· cm Â· ft Â· mi</span>
                    </div>
                    <div class="converter-inputs">
                        <div>
                            <label class="field-label" for="length-input">è¾“å…¥æ•°å€¼</label>
                            <input class="input" id="length-input" type="number" placeholder="è¾“å…¥é•¿åº¦">
                        </div>
                        <div>
                            <label class="field-label" for="length-from">åŸå§‹å•ä½</label>
                            <select id="length-from">
                                <option value="m">ç±³ (m)</option>
                                <option value="km">åƒç±³ (km)</option>
                                <option value="cm">å˜ç±³ (cm)</option>
                                <option value="mm">æ¯«ç±³ (mm)</option>
                                <option value="ft">è‹±å°º (ft)</option>
                                <option value="in">è‹±å¯¸ (in)</option>
                                <option value="mi">è‹±é‡Œ (mi)</option>
                            </select>
                        </div>
                        <div>
                            <label class="field-label" for="length-to">ç›®æ ‡å•ä½</label>
                            <select id="length-to">
                                <option value="m">ç±³ (m)</option>
                                <option value="km">åƒç±³ (km)</option>
                                <option value="cm">å˜ç±³ (cm)</option>
                                <option value="mm">æ¯«ç±³ (mm)</option>
                                <option value="ft" selected>è‹±å°º (ft)</option>
                                <option value="in">è‹±å¯¸ (in)</option>
                                <option value="mi">è‹±é‡Œ (mi)</option>
                            </select>
                        </div>
                    </div>
                    <p class="converter-result" id="length-result"></p>
                </div>

                <div class="converter-block" data-type="weight">
                    <div class="inline-group" style="justify-content: space-between;">
                        <h3 style="font-size: 1.05rem;">é‡é‡è½¬æ¢</h3>
                        <span class="chip">kg Â· g Â· lb Â· oz</span>
                    </div>
                    <div class="converter-inputs">
                        <div>
                            <label class="field-label" for="weight-input">è¾“å…¥æ•°å€¼</label>
                            <input class="input" id="weight-input" type="number" placeholder="è¾“å…¥é‡é‡">
                        </div>
                        <div>
                            <label class="field-label" for="weight-from">åŸå§‹å•ä½</label>
                            <select id="weight-from">
                                <option value="kg">åƒå…‹ (kg)</option>
                                <option value="g">å…‹ (g)</option>
                                <option value="lb">ç£… (lb)</option>
                                <option value="oz">ç›å¸ (oz)</option>
                            </select>
                        </div>
                        <div>
                            <label class="field-label" for="weight-to">ç›®æ ‡å•ä½</label>
                            <select id="weight-to">
                                <option value="kg">åƒå…‹ (kg)</option>
                                <option value="g">å…‹ (g)</option>
                                <option value="lb" selected>ç£… (lb)</option>
                                <option value="oz">ç›å¸ (oz)</option>
                            </select>
                        </div>
                    </div>
                    <p class="converter-result" id="weight-result"></p>
                </div>

                <div class="converter-block" data-type="temperature">
                    <div class="inline-group" style="justify-content: space-between;">
                        <h3 style="font-size: 1.05rem;">æ¸©åº¦è½¬æ¢</h3>
                        <span class="chip">â„ƒ Â· â„‰ Â· K</span>
                    </div>
                    <div class="converter-inputs">
                        <div>
                            <label class="field-label" for="temp-input">è¾“å…¥æ•°å€¼</label>
                            <input class="input" id="temp-input" type="number" placeholder="è¾“å…¥æ¸©åº¦">
                        </div>
                        <div>
                            <label class="field-label" for="temp-from">åŸå§‹å•ä½</label>
                            <select id="temp-from">
                                <option value="C">æ‘„æ°åº¦ (Â°C)</option>
                                <option value="F">åæ°åº¦ (Â°F)</option>
                                <option value="K">å¼€å°”æ–‡ (K)</option>
                            </select>
                        </div>
                        <div>
                            <label class="field-label" for="temp-to">ç›®æ ‡å•ä½</label>
                            <select id="temp-to">
                                <option value="C">æ‘„æ°åº¦ (Â°C)</option>
                                <option value="F" selected>åæ°åº¦ (Â°F)</option>
                                <option value="K">å¼€å°”æ–‡ (K)</option>
                            </select>
                        </div>
                    </div>
                    <p class="converter-result" id="temp-result"></p>
                </div>
            </div>
        </section>

        <!-- BMI -->
        <section id="bmi" class="tool-content" aria-labelledby="bmi">
            <div class="card">
                <h2><span>âš–ï¸</span>BMI ä½“è„‚è¯„ä¼°</h2>
                <p class="card-subtitle">è¾“å…¥èº«é«˜ä¸ä½“é‡ï¼ŒæŸ¥çœ‹ BMI å€¼åŠå¥åº·åŒºé—´æç¤º</p>

                <div class="bmi-grid">
                    <div>
                        <label class="field-label" for="bmi-height">èº«é«˜ (cm)</label>
                        <input class="input" id="bmi-height" type="number" placeholder="175" min="80" max="250">
                    </div>
                    <div>
                        <label class="field-label" for="bmi-weight">ä½“é‡ (kg)</label>
                        <input class="input" id="bmi-weight" type="number" placeholder="68" min="20" max="250">
                    </div>
                </div>

                <div class="bmi-result" id="bmi-result" aria-live="polite">
                    <div class="bmi-value" id="bmi-value">0.0</div>
                    <div class="bmi-category" id="bmi-category">è¯·è¾“å…¥èº«é«˜ä¸ä½“é‡</div>
                    <div class="bmi-scale" aria-hidden="true">
                        <div></div><div></div><div></div><div></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Timer -->
        <section id="timer" class="tool-content" aria-labelledby="timer">
            <div class="card">
                <h2><span>â±ï¸</span>å€’è®¡æ—¶å®šæ—¶å™¨</h2>
                <p class="card-subtitle">è®¾ç½®æ—¶ã€åˆ†ã€ç§’å¹¶å¯åŠ¨å€’è®¡æ—¶ï¼Œæ”¯æŒæš‚åœä¸é‡ç½®</p>

                <div class="timer-display" id="timer-display">00:05:00</div>

                <div class="timer-inputs">
                    <input id="timer-hours" type="number" min="0" max="99" value="0" aria-label="å°æ—¶">
                    <input id="timer-minutes" type="number" min="0" max="59" value="5" aria-label="åˆ†é’Ÿ">
                    <input id="timer-seconds" type="number" min="0" max="59" value="0" aria-label="ç§’">
                </div>

                <div class="timer-controls">
                    <button class="btn btn-primary" id="timer-start">å¼€å§‹</button>
                    <button class="btn btn-secondary" id="timer-pause">æš‚åœ</button>
                    <button class="btn btn-ghost" id="timer-reset">é‡ç½®</button>
                </div>
            </div>
        </section>

        <!-- Currency converter -->
        <section id="currency" class="tool-content" aria-labelledby="currency">
            <div class="card">
                <h2><span>ğŸ’±</span>å®æ—¶æ±‡ç‡è½¬æ¢</h2>
                <p class="card-subtitle">åŸºäº ExchangeRate-API å…è´¹æ¥å£ï¼Œé¦–æ¬¡åŠ è½½éœ€ç­‰å¾…æ±‡ç‡æ•°æ®</p>

                <div class="grid two">
                    <div>
                        <label class="field-label" for="currency-amount">é‡‘é¢</label>
                        <input class="input" id="currency-amount" type="number" placeholder="100" value="100" min="0" step="0.01">
                    </div>
                    <div class="inline-group" style="justify-content: flex-end; gap: 10px;">
                        <button class="btn btn-ghost" id="currency-refresh">åˆ·æ–°æ±‡ç‡</button>
                        <button class="btn btn-secondary" id="currency-swap">â‡„ äº’æ¢</button>
                    </div>
                </div>

                <div class="grid two" style="margin-top: 22px;">
                    <div>
                        <label class="field-label" for="currency-from">åŸå¸ç§</label>
                        <select id="currency-from"></select>
                    </div>
                    <div>
                        <label class="field-label" for="currency-to">ç›®æ ‡å¸ç§</label>
                        <select id="currency-to"></select>
                    </div>
                </div>

                <div class="currency-result" id="currency-result">--</div>
                <p class="status-text" id="currency-updated">æ­£åœ¨åŠ è½½æ±‡ç‡...</p>

                <div class="rates-grid" id="currency-highlights" aria-live="polite"></div>
            </div>
        </section>

        <!-- Password generator -->
        <section id="password" class="tool-content" aria-labelledby="password">
            <div class="card">
                <h2><span>ğŸ”</span>å®‰å…¨å¯†ç ç”Ÿæˆå™¨</h2>
                <p class="card-subtitle">æ”¯æŒå¤§å°å†™å­—æ¯ã€æ•°å­—ã€ç¬¦å·ï¼Œè‡ªå®šä¹‰é•¿åº¦å¹¶å¿«é€Ÿå¤åˆ¶</p>

                <div class="grid two">
                    <div>
                        <span class="field-label">å¯†ç é•¿åº¦</span>
                        <div class="range-wrapper">
                            <input id="password-length" type="range" min="6" max="48" value="16">
                            <span id="password-length-value">16</span>
                        </div>
                    </div>
                    <div class="inline-group" style="justify-content: flex-end; gap: 10px;">
                        <label class="switch">
                            <input type="checkbox" id="password-lower" checked>
                            <span>å°å†™</span>
                        </label>
                        <label class="switch">
                            <input type="checkbox" id="password-upper" checked>
                            <span>å¤§å†™</span>
                        </label>
                        <label class="switch">
                            <input type="checkbox" id="password-number" checked>
                            <span>æ•°å­—</span>
                        </label>
                        <label class="switch">
                            <input type="checkbox" id="password-symbol" checked>
                            <span>ç¬¦å·</span>
                        </label>
                    </div>
                </div>

                <div class="password-output" id="password-output">
                    <span id="password-value">ç‚¹å‡»ç”Ÿæˆå¯†ç </span>
                    <div class="inline-group">
                        <button class="btn btn-primary" id="password-generate">ç”Ÿæˆ</button>
                        <button class="btn btn-secondary" id="password-copy">å¤åˆ¶</button>
                    </div>
                </div>

                <p class="status-text" id="password-status"></p>
            </div>
        </section>

        <!-- Color picker -->
        <section id="color" class="tool-content" aria-labelledby="color">
            <div class="card">
                <h2><span>ğŸ¨</span>é¢œè‰²é€‰æ‹©å™¨</h2>
                <p class="card-subtitle">é€‰æ‹©è‰²å½©æˆ–è¾“å…¥ HEX å€¼ï¼Œå°†è‡ªåŠ¨è½¬æ¢ä¸º RGB ä¸ HSL</p>

                <div class="grid two" style="align-items: center;">
                    <div class="inline-group" style="gap: 20px;">
                        <div class="color-preview" id="color-preview"></div>
                        <div>
                            <label class="field-label" for="color-input">é€‰æ‹©é¢œè‰²</label>
                            <input id="color-input" type="color" value="#4f46e5">
                            <label class="field-label" for="color-hex" style="margin-top: 18px;">HEX è¾“å…¥</label>
                            <input class="input" id="color-hex" type="text" value="#4f46e5" placeholder="#4f46e5">
                        </div>
                    </div>
                    <div class="color-values">
                        <div class="color-row">
                            <span>HEX</span>
                            <span id="color-hex-value">#4F46E5</span>
                        </div>
                        <div class="color-row">
                            <span>RGB</span>
                            <span id="color-rgb-value">79, 70, 229</span>
                        </div>
                        <div class="color-row">
                            <span>HSL</span>
                            <span id="color-hsl-value">243Â°, 79%, 59%</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- JSON formatter -->
        <section id="json" class="tool-content" aria-labelledby="json">
            <div class="card">
                <h2><span>ğŸ§¾</span>JSON æ ¼å¼åŒ–å·¥å…·</h2>
                <p class="card-subtitle">ç²˜è´´ JSON å­—ç¬¦ä¸²ï¼Œä¸€é”®æ ¼å¼åŒ–æˆ–å‹ç¼©ï¼Œæ–¹ä¾¿é˜…è¯»ä¸ä¼ è¾“</p>

                <label class="field-label" for="json-input">è¾“å…¥ JSON</label>
                <textarea id="json-input" placeholder='{"hello":"world"}'></textarea>

                <div class="json-actions">
                    <button class="btn btn-primary" id="json-format">æ ¼å¼åŒ–</button>
                    <button class="btn btn-secondary" id="json-minify">å‹ç¼©</button>
                    <button class="btn btn-ghost" id="json-copy">å¤åˆ¶è¾“å‡º</button>
                    <button class="btn btn-ghost" id="json-clear">æ¸…ç©º</button>
                </div>

                <div class="json-output" id="json-output">ç»“æœä¼šæ˜¾ç¤ºåœ¨è¿™é‡Œ</div>
                <p class="error-text" id="json-error"></p>
            </div>
        </section>

        <footer>
            <p>ğŸ§  Powered by <a href="https://github.com/ocean-Go/jarvis-toolkit" target="_blank" rel="noreferrer">Jarvis Toolkit</a> Â· Crafted with ğŸ’œ by Codex</p>
        </footer>
    </div>

    <script>
        const Toolkit = (() => {
            const state = {
                calcExpression: '',
                timer: {
                    interval: null,
                    totalSeconds: 300,
                    running: false,
                },
                currency: {
                    base: 'USD',
                    target: 'CNY',
                    amount: 100,
                    rates: {},
                    updatedAt: null,
                    loading: false,
                }
            };

            const selectors = {
                tabs: document.querySelectorAll('.tab-btn'),
                contents: document.querySelectorAll('.tool-content'),
                weatherCards: document.querySelectorAll('.weather-card'),
                weatherDetail: document.getElementById('weather-detail'),
                calcExpression: document.getElementById('calc-expression'),
                calcResult: document.getElementById('calc-result'),
                calcGrid: document.getElementById('calc-grid'),
                converter: {
                    length: {
                        input: document.getElementById('length-input'),
                        from: document.getElementById('length-from'),
                        to: document.getElementById('length-to'),
                        result: document.getElementById('length-result')
                    },
                    weight: {
                        input: document.getElementById('weight-input'),
                        from: document.getElementById('weight-from'),
                        to: document.getElementById('weight-to'),
                        result: document.getElementById('weight-result')
                    },
                    temp: {
                        input: document.getElementById('temp-input'),
                        from: document.getElementById('temp-from'),
                        to: document.getElementById('temp-to'),
                        result: document.getElementById('temp-result')
                    }
                },
                bmi: {
                    height: document.getElementById('bmi-height'),
                    weight: document.getElementById('bmi-weight'),
                    resultCard: document.getElementById('bmi-result'),
                    value: document.getElementById('bmi-value'),
                    category: document.getElementById('bmi-category')
                },
                timer: {
                    display: document.getElementById('timer-display'),
                    hours: document.getElementById('timer-hours'),
                    minutes: document.getElementById('timer-minutes'),
                    seconds: document.getElementById('timer-seconds'),
                    start: document.getElementById('timer-start'),
                    pause: document.getElementById('timer-pause'),
                    reset: document.getElementById('timer-reset')
                },
                currency: {
                    amount: document.getElementById('currency-amount'),
                    from: document.getElementById('currency-from'),
                    to: document.getElementById('currency-to'),
                    swap: document.getElementById('currency-swap'),
                    refresh: document.getElementById('currency-refresh'),
                    result: document.getElementById('currency-result'),
                    updated: document.getElementById('currency-updated'),
                    highlights: document.getElementById('currency-highlights'),
                },
                password: {
                    length: document.getElementById('password-length'),
                    lengthValue: document.getElementById('password-length-value'),
                    lower: document.getElementById('password-lower'),
                    upper: document.getElementById('password-upper'),
                    number: document.getElementById('password-number'),
                    symbol: document.getElementById('password-symbol'),
                    generate: document.getElementById('password-generate'),
                    copy: document.getElementById('password-copy'),
                    value: document.getElementById('password-value'),
                    status: document.getElementById('password-status')
                },
                color: {
                    preview: document.getElementById('color-preview'),
                    input: document.getElementById('color-input'),
                    hexInput: document.getElementById('color-hex'),
                    hexValue: document.getElementById('color-hex-value'),
                    rgbValue: document.getElementById('color-rgb-value'),
                    hslValue: document.getElementById('color-hsl-value')
                },
                json: {
                    input: document.getElementById('json-input'),
                    output: document.getElementById('json-output'),
                    error: document.getElementById('json-error'),
                    format: document.getElementById('json-format'),
                    minify: document.getElementById('json-minify'),
                    copy: document.getElementById('json-copy'),
                    clear: document.getElementById('json-clear')
                }
            };

            const calculatorButtons = [
                { label: 'C', action: 'clear', className: 'clear' },
                { label: 'âŒ«', action: 'backspace' },
                { label: '%', value: '%', className: 'operator' },
                { label: 'Ã·', value: '/', className: 'operator' },
                { label: '7', value: '7' },
                { label: '8', value: '8' },
                { label: '9', value: '9' },
                { label: 'Ã—', value: '*', className: 'operator' },
                { label: '4', value: '4' },
                { label: '5', value: '5' },
                { label: '6', value: '6' },
                { label: 'âˆ’', value: '-', className: 'operator' },
                { label: '1', value: '1' },
                { label: '2', value: '2' },
                { label: '3', value: '3' },
                { label: '+', value: '+', className: 'operator' },
                { label: '0', value: '0' },
                { label: '.', value: '.' },
                { label: '=', action: 'equals', className: 'equals' }
            ];

            const currencyList = [
                'USD', 'EUR', 'CNY', 'JPY', 'GBP', 'AUD', 'CAD', 'HKD', 'SGD', 'KRW',
                'TWD', 'CHF', 'SEK', 'NZD', 'THB', 'MYR', 'VND', 'PHP', 'IDR', 'RUB'
            ];

            const unitFactors = {
                length: { m: 1, km: 1000, cm: 0.01, mm: 0.001, ft: 0.3048, in: 0.0254, mi: 1609.344 },
                weight: { kg: 1, g: 0.001, lb: 0.45359237, oz: 0.0283495231 }
            };

            const TIMER_INTERVAL = 1000;
            const API_BASE = 'https://open.er-api.com/v6/latest/';

            // Tabs
            const initTabs = () => {
                selectors.tabs.forEach((tab) => {
                    tab.addEventListener('click', () => {
                        selectors.tabs.forEach((btn) => btn.classList.remove('active'));
                        selectors.contents.forEach((content) => content.classList.remove('active'));
                        tab.classList.add('active');
                        const target = document.getElementById(tab.dataset.tab);
                        if (target) target.classList.add('active');
                    });
                });
            };

            // Weather
            const updateWeatherDetail = (card) => {
                if (!card) return;
                const { city, temp, condition, emoji } = card.dataset;
                selectors.weatherDetail.innerHTML = `
                    <div style="display:flex; justify-content:space-between; align-items:center;">
                        <div>
                            <div style="font-size:1.1rem; color:var(--text-secondary);">å½“å‰åŸå¸‚</div>
                            <div style="font-size:1.6rem; font-weight:700; margin-top:6px;">${emoji || ''} ${city}</div>
                        </div>
                        <div style="text-align:right;">
                            <div style="font-size:2.4rem; font-weight:700;">${temp}Â°C</div>
                            <div style="color:var(--text-secondary); margin-top:4px;">${condition}</div>
                        </div>
                    </div>
                `;
            };

            const initWeather = () => {
                selectors.weatherCards.forEach((card) => {
                    card.addEventListener('click', () => {
                        selectors.weatherCards.forEach((c) => c.classList.remove('active'));
                        card.classList.add('active');
                        updateWeatherDetail(card);
                    });
                });
                updateWeatherDetail(document.querySelector('.weather-card.active'));
            };

            // Calculator
            const renderCalculator = () => {
                const fragment = document.createDocumentFragment();
                calculatorButtons.forEach((btnConfig) => {
                    const btn = document.createElement('button');
                    btn.textContent = btnConfig.label;
                    btn.className = `calc-btn${btnConfig.className ? ' ' + btnConfig.className : ''}`;
                    if (btnConfig.value) btn.dataset.value = btnConfig.value;
                    if (btnConfig.action) btn.dataset.action = btnConfig.action;
                    fragment.appendChild(btn);
                });
                selectors.calcGrid.appendChild(fragment);
            };

            const updateCalcDisplay = () => {
                selectors.calcExpression.textContent = state.calcExpression;
                selectors.calcResult.textContent = state.calcExpression ? state.calcExpression : '0';
            };

            const evaluateExpression = () => {
                try {
                    const result = Function(`"use strict"; return (${state.calcExpression});`)();
                    state.calcExpression = result.toString();
                    selectors.calcResult.textContent = result;
                    selectors.calcExpression.textContent = result;
                } catch (error) {
                    selectors.calcResult.textContent = 'Error';
                }
            };

            const bindCalculatorEvents = () => {
                selectors.calcGrid.addEventListener('click', (event) => {
                    const target = event.target.closest('button');
                    if (!target) return;

                    const { value, action } = target.dataset;

                    if (action === 'clear') {
                        state.calcExpression = '';
                        updateCalcDisplay();
                        return;
                    }

                    if (action === 'backspace') {
                        state.calcExpression = state.calcExpression.slice(0, -1);
                        updateCalcDisplay();
                        return;
                    }

                    if (action === 'equals') {
                        evaluateExpression();
                        return;
                    }

                    if (value) {
                        state.calcExpression += value;
                        updateCalcDisplay();
                    }
                });

                document.addEventListener('keydown', (event) => {
                    if (event.key.match(/[0-9+\-*/.%]/)) {
                        state.calcExpression += event.key;
                        updateCalcDisplay();
                    } else if (event.key === 'Enter') {
                        evaluateExpression();
                    } else if (event.key === 'Backspace') {
                        state.calcExpression = state.calcExpression.slice(0, -1);
                        updateCalcDisplay();
                    } else if (event.key === 'Escape') {
                        state.calcExpression = '';
                        updateCalcDisplay();
                    }
                });
            };

            // Unit converters
            const convertLength = () => {
                const { input, from, to, result } = selectors.converter.length;
                const value = parseFloat(input.value);
                if (Number.isNaN(value)) {
                    result.textContent = '';
                    return;
                }
                const meters = value * unitFactors.length[from.value];
                const converted = meters / unitFactors.length[to.value];
                result.textContent = `${value} ${from.value} = ${converted.toFixed(4)} ${to.value}`;
            };

            const convertWeight = () => {
                const { input, from, to, result } = selectors.converter.weight;
                const value = parseFloat(input.value);
                if (Number.isNaN(value)) {
                    result.textContent = '';
                    return;
                }
                const kg = value * unitFactors.weight[from.value];
                const converted = kg / unitFactors.weight[to.value];
                result.textContent = `${value} ${from.value} = ${converted.toFixed(4)} ${to.value}`;
            };

            const convertTemperature = () => {
                const { input, from, to, result } = selectors.converter.temp;
                let value = parseFloat(input.value);
                if (Number.isNaN(value)) {
                    result.textContent = '';
                    return;
                }

                if (from.value === 'F') value = (value - 32) * 5 / 9;
                if (from.value === 'K') value = value - 273.15;

                let output = value;
                if (to.value === 'F') output = (value * 9 / 5) + 32;
                if (to.value === 'K') output = value + 273.15;

                result.textContent = `${input.value}Â°${from.value} = ${output.toFixed(2)}Â°${to.value}`;
            };

            const initConverters = () => {
                const { length, weight, temp } = selectors.converter;
                ['input', 'change'].forEach((event) => {
                    length.input.addEventListener(event, convertLength);
                    length.from.addEventListener(event, convertLength);
                    length.to.addEventListener(event, convertLength);
                    weight.input.addEventListener(event, convertWeight);
                    weight.from.addEventListener(event, convertWeight);
                    weight.to.addEventListener(event, convertWeight);
                    temp.input.addEventListener(event, convertTemperature);
                    temp.from.addEventListener(event, convertTemperature);
                    temp.to.addEventListener(event, convertTemperature);
                });
            };

            // BMI
            const calculateBMI = () => {
                const height = parseFloat(selectors.bmi.height.value);
                const weight = parseFloat(selectors.bmi.weight.value);
                if (Number.isNaN(height) || Number.isNaN(weight) || height <= 0 || weight <= 0) {
                    selectors.bmi.resultCard.classList.remove('show');
                    selectors.bmi.category.textContent = 'è¯·è¾“å…¥æœ‰æ•ˆçš„èº«é«˜å’Œä½“é‡';
                    return;
                }

                const bmiValue = weight / ((height / 100) ** 2);
                selectors.bmi.value.textContent = bmiValue.toFixed(1);

                let category = 'åç˜¦';
                let color = '#60a5fa';
                if (bmiValue >= 18.5 && bmiValue < 24) {
                    category = 'æ­£å¸¸';
                    color = '#34d399';
                } else if (bmiValue >= 24 && bmiValue < 28) {
                    category = 'åèƒ–';
                    color = '#fbbf24';
                } else if (bmiValue >= 28) {
                    category = 'è‚¥èƒ–';
                    color = '#f87171';
                }

                selectors.bmi.category.textContent = `å¥åº·åŒºé—´ï¼š${category}`;
                selectors.bmi.category.style.color = color;
                selectors.bmi.value.style.color = color;
                selectors.bmi.resultCard.classList.add('show');
            };

            const initBMI = () => {
                ['input', 'change'].forEach((event) => {
                    selectors.bmi.height.addEventListener(event, calculateBMI);
                    selectors.bmi.weight.addEventListener(event, calculateBMI);
                });
            };

            // Timer
            const updateTimerDisplay = () => {
                const { totalSeconds } = state.timer;
                const hours = Math.floor(totalSeconds / 3600).toString().padStart(2, '0');
                const minutes = Math.floor((totalSeconds % 3600) / 60).toString().padStart(2, '0');
                const seconds = (totalSeconds % 60).toString().padStart(2, '0');
                selectors.timer.display.textContent = `${hours}:${minutes}:${seconds}`;
            };

            const startTimer = () => {
                if (state.timer.running) return;

                const hours = parseInt(selectors.timer.hours.value, 10) || 0;
                const minutes = parseInt(selectors.timer.minutes.value, 10) || 0;
                const seconds = parseInt(selectors.timer.seconds.value, 10) || 0;
                const total = hours * 3600 + minutes * 60 + seconds;

                if (total <= 0) return;

                state.timer.totalSeconds = total;
                state.timer.running = true;
                updateTimerDisplay();

                state.timer.interval = setInterval(() => {
                    state.timer.totalSeconds -= 1;
                    updateTimerDisplay();
                    if (state.timer.totalSeconds <= 0) {
                        clearInterval(state.timer.interval);
                        state.timer.running = false;
                        alert('â° æ—¶é—´åˆ°ï¼');
                    }
                }, TIMER_INTERVAL);
            };

            const pauseTimer = () => {
                clearInterval(state.timer.interval);
                state.timer.running = false;
            };

            const resetTimer = () => {
                pauseTimer();
                state.timer.totalSeconds = 0;
                updateTimerDisplay();
            };

            const initTimer = () => {
                updateTimerDisplay();
                selectors.timer.start.addEventListener('click', startTimer);
                selectors.timer.pause.addEventListener('click', pauseTimer);
                selectors.timer.reset.addEventListener('click', () => {
                    resetTimer();
                    selectors.timer.hours.value = 0;
                    selectors.timer.minutes.value = 5;
                    selectors.timer.seconds.value = 0;
                    state.timer.totalSeconds = 300;
                    updateTimerDisplay();
                });
            };

            // Currency converter
            const fillCurrencyOptions = () => {
                const { from, to } = selectors.currency;
                currencyList.forEach((code) => {
                    const optionFrom = document.createElement('option');
                    optionFrom.value = code;
                    optionFrom.textContent = `${code}`;
                    if (code === state.currency.base) optionFrom.selected = true;
                    from.appendChild(optionFrom);

                    const optionTo = document.createElement('option');
                    optionTo.value = code;
                    optionTo.textContent = `${code}`;
                    if (code === state.currency.target) optionTo.selected = true;
                    to.appendChild(optionTo);
                });
            };

            const formatCurrency = (value, currency = 'USD') => {
                try {
                    return new Intl.NumberFormat('zh-CN', {
                        style: 'currency',
                        currency,
                        maximumFractionDigits: value % 1 === 0 ? 0 : 4
                    }).format(value);
                } catch (error) {
                    return `${value.toFixed(4)} ${currency}`;
                }
            };

            const updateCurrencyUI = () => {
                const { amount, base, target, rates, updatedAt, loading } = state.currency;
                selectors.currency.amount.value = amount;
                selectors.currency.result.textContent = loading ? 'åŠ è½½ä¸­...' : '--';

                if (loading) {
                    selectors.currency.updated.textContent = 'æ­£åœ¨åŠ è½½æ±‡ç‡...';
                    selectors.currency.highlights.innerHTML = '';
                    return;
                }

                const rate = rates[target];
                if (!rate) {
                    selectors.currency.result.textContent = 'æœªè·å–åˆ°ç›®æ ‡å¸ç§æ±‡ç‡';
                    return;
                }

                const converted = amount * rate;
                selectors.currency.result.textContent = `${formatCurrency(amount, base)} â‰ˆ ${formatCurrency(converted, target)}`;

                selectors.currency.updated.textContent = updatedAt
                    ? `æœ€åæ›´æ–°æ—¶é—´ï¼š${updatedAt.toLocaleString('zh-CN')}`
                    : 'å°šæœªåˆ·æ–°æ±‡ç‡';

                const highlightCodes = Array.from(new Set([base, target, 'USD', 'CNY', 'EUR', 'JPY']));
                selectors.currency.highlights.innerHTML = '';
                highlightCodes.forEach((code) => {
                    const baseToCode = rates[code];
                    if (!baseToCode) return;
                    const badge = document.createElement('div');
                    badge.className = 'rate-badge';
                    const codeToBase = 1 / baseToCode;
                    const codeToTarget = rates[target] ? (rates[target] / baseToCode) : null;
                    badge.innerHTML = `
                        <strong style="display:block;font-size:1rem;margin-bottom:4px;">${code}</strong>
                        <div style="font-size:0.85rem;">1 ${base} â‰ˆ ${baseToCode.toFixed(4)} ${code}</div>
                        <div style="font-size:0.85rem;">1 ${code} â‰ˆ ${codeToBase.toFixed(4)} ${base}</div>
                        ${codeToTarget && code !== target ? `<div style="font-size:0.85rem;">1 ${code} â‰ˆ ${codeToTarget.toFixed(4)} ${target}</div>` : ''}
                    `;
                    selectors.currency.highlights.appendChild(badge);
                });
            };

            const fetchRates = async (base) => {
                state.currency.loading = true;
                updateCurrencyUI();
                try {
                    const response = await fetch(`${API_BASE}${base}`);
                    const data = await response.json();
                    if (data.result === 'success') {
                        state.currency.rates = data.rates;
                        state.currency.base = data.base_code;
                        state.currency.updatedAt = new Date(data.time_last_update_utc);
                    } else {
                        throw new Error(data['error-type'] || 'æ±‡ç‡æ¥å£è¿”å›å¼‚å¸¸');
                    }
                } catch (error) {
                    selectors.currency.updated.textContent = `è·å–æ±‡ç‡å¤±è´¥ï¼š${error.message}`;
                } finally {
                    state.currency.loading = false;
                    updateCurrencyUI();
                }
            };

            const initCurrencyConverter = () => {
                fillCurrencyOptions();
                fetchRates(state.currency.base);

                selectors.currency.amount.addEventListener('input', (event) => {
                    state.currency.amount = Number(event.target.value) || 0;
                    updateCurrencyUI();
                });

                selectors.currency.from.addEventListener('change', (event) => {
                    state.currency.base = event.target.value;
                    fetchRates(state.currency.base);
                });

                selectors.currency.to.addEventListener('change', (event) => {
                    state.currency.target = event.target.value;
                    updateCurrencyUI();
                });

                selectors.currency.swap.addEventListener('click', () => {
                    [state.currency.base, state.currency.target] = [state.currency.target, state.currency.base];
                    selectors.currency.from.value = state.currency.base;
                    selectors.currency.to.value = state.currency.target;
                    fetchRates(state.currency.base);
                });

                selectors.currency.refresh.addEventListener('click', () => {
                    fetchRates(state.currency.base);
                });
            };

            // Password generator
            const randomChar = {
                lower: () => String.fromCharCode(Math.floor(Math.random() * 26) + 97),
                upper: () => String.fromCharCode(Math.floor(Math.random() * 26) + 65),
                number: () => String.fromCharCode(Math.floor(Math.random() * 10) + 48),
                symbol: () => '`~!@#$%^&*()_+-={}[]|:;"<>,.?/'.charAt(Math.floor(Math.random() * 30))
            };

            const generatePassword = () => {
                const length = parseInt(selectors.password.length.value, 10);
                const options = ['lower', 'upper', 'number', 'symbol'].filter((type) => selectors.password[type].checked);

                if (options.length === 0) {
                    selectors.password.status.textContent = 'è‡³å°‘é€‰æ‹©ä¸€ç§å­—ç¬¦ç±»å‹';
                    selectors.password.status.style.color = '#f87171';
                    return;
                }

                let password = '';
                while (password.length < length) {
                    for (const type of options) {
                        if (password.length < length) {
                            password += randomChar[type]();
                        }
                    }
                }

                const shuffled = password
                    .split('')
                    .sort(() => Math.random() - 0.5)
                    .join('');

                selectors.password.value.textContent = shuffled;
                selectors.password.status.textContent = `å·²ç”Ÿæˆ ${length} ä½å¯†ç `;
                selectors.password.status.style.color = 'var(--text-secondary)';
            };

            const copyToClipboard = async (text, onSuccess, onError) => {
                try {
                    await navigator.clipboard.writeText(text);
                    onSuccess();
                } catch (error) {
                    onError(error);
                }
            };

            const initPasswordGenerator = () => {
                selectors.password.length.addEventListener('input', (event) => {
                    selectors.password.lengthValue.textContent = event.target.value;
                });

                selectors.password.generate.addEventListener('click', generatePassword);

                selectors.password.copy.addEventListener('click', () => {
                    const password = selectors.password.value.textContent;
                    if (!password || password === 'ç‚¹å‡»ç”Ÿæˆå¯†ç ') return;
                    copyToClipboard(
                        password,
                        () => {
                            selectors.password.status.textContent = 'å·²å¤åˆ¶åˆ°å‰ªè´´æ¿';
                            selectors.password.status.style.color = 'var(--accent-green)';
                        },
                        (error) => {
                            selectors.password.status.textContent = `å¤åˆ¶å¤±è´¥ï¼š${error.message}`;
                            selectors.password.status.style.color = '#f87171';
                        }
                    );
                });
            };

            // Color picker
            const hexToRgb = (hex) => {
                const sanitized = hex.replace('#', '');
                if (![3, 6].includes(sanitized.length)) return null;
                const normalized = sanitized.length === 3
                    ? sanitized.split('').map((c) => c + c).join('')
                    : sanitized;
                const bigint = parseInt(normalized, 16);
                return {
                    r: (bigint >> 16) & 255,
                    g: (bigint >> 8) & 255,
                    b: bigint & 255,
                };
            };

            const rgbToHsl = ({ r, g, b }) => {
                r /= 255; g /= 255; b /= 255;
                const max = Math.max(r, g, b);
                const min = Math.min(r, g, b);
                let h; let s;
                const l = (max + min) / 2;

                if (max === min) {
                    h = s = 0;
                } else {
                    const d = max - min;
                    s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
                    switch (max) {
                        case r: h = (g - b) / d + (g < b ? 6 : 0); break;
                        case g: h = (b - r) / d + 2; break;
                        default: h = (r - g) / d + 4; break;
                    }
                    h /= 6;
                }

                return {
                    h: Math.round(h * 360),
                    s: Math.round(s * 100),
                    l: Math.round(l * 100)
                };
            };

            const updateColorValues = (hex) => {
                const rgb = hexToRgb(hex);
                if (!rgb) return;
                const hsl = rgbToHsl(rgb);

                selectors.color.preview.style.background = hex;
                selectors.color.hexInput.value = hex;
                selectors.color.hexValue.textContent = hex.toUpperCase();
                selectors.color.rgbValue.textContent = `${rgb.r}, ${rgb.g}, ${rgb.b}`;
                selectors.color.hslValue.textContent = `${hsl.h}Â°, ${hsl.s}%, ${hsl.l}%`;
            };

            const initColorPicker = () => {
                updateColorValues(selectors.color.input.value);
                selectors.color.input.addEventListener('input', (event) => {
                    updateColorValues(event.target.value);
                });

                selectors.color.hexInput.addEventListener('input', (event) => {
                    const value = event.target.value.startsWith('#') ? event.target.value : `#${event.target.value}`;
                    if (/^#([0-9a-fA-F]{3}){1,2}$/.test(value)) {
                        selectors.color.input.value = value;
                        updateColorValues(value);
                    }
                });
            };

            // JSON formatter
            const formatJSON = (spacing = 2) => {
                try {
                    const parsed = JSON.parse(selectors.json.input.value);
                    selectors.json.output.textContent = JSON.stringify(parsed, null, spacing);
                    selectors.json.error.textContent = '';
                } catch (error) {
                    selectors.json.error.textContent = `JSON è§£æå¤±è´¥ï¼š${error.message}`;
                }
            };

            const initJSONTool = () => {
                selectors.json.format.addEventListener('click', () => formatJSON(2));
                selectors.json.minify.addEventListener('click', () => formatJSON(0));
                selectors.json.clear.addEventListener('click', () => {
                    selectors.json.input.value = '';
                    selectors.json.output.textContent = 'ç»“æœä¼šæ˜¾ç¤ºåœ¨è¿™é‡Œ';
                    selectors.json.error.textContent = '';
                });
                selectors.json.copy.addEventListener('click', () => {
                    const text = selectors.json.output.textContent;
                    if (!text || text === 'ç»“æœä¼šæ˜¾ç¤ºåœ¨è¿™é‡Œ') return;
                    copyToClipboard(
                        text,
                        () => {
                            selectors.json.error.style.color = 'var(--accent-green)';
                            selectors.json.error.textContent = 'å·²å¤åˆ¶åˆ°å‰ªè´´æ¿';
                        },
                        (error) => {
                            selectors.json.error.style.color = '#f87171';
                            selectors.json.error.textContent = `å¤åˆ¶å¤±è´¥ï¼š${error.message}`;
                        }
                    );
                });
            };

            const init = () => {
                initTabs();
                initWeather();
                renderCalculator();
                bindCalculatorEvents();
                initConverters();
                initBMI();
                initTimer();
                initCurrencyConverter();
                initPasswordGenerator();
                initColorPicker();
                initJSONTool();
                updateCurrencyUI();
            };

            return { init };
        })();

        document.addEventListener('DOMContentLoaded', Toolkit.init);
    </script>
</body>
</html>
